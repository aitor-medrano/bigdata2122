# Datos en la nube

Ya hemos visto que el almacenamiento en la nube ofrece un gran número de ventajas. Otro de los productos estrella de la computación en la nube es el uso de bases de datos, ya sean distribuidas o no.

La principal ventaja de utilizar un servicio de base de datos basado en la nube es que no requieren de la administración por parte del usuario. Éste sólo utiliza el servicio sin necesidad de tener conocimientos avanzados sobre su administración. Estos servicios se conocen como **administrados**, ya que la propia AWS se encarga de gestionar el escalado, la tolerancia a errores y la disponibilidad, y por tanto, estos servicios forman parte de una solución PaaS.

Si nosotros creásemos una instancia EC2 e instalásemos cualquier sistema gestor de base de datos, como MariaDB o PostreSQL, seríamos responsables de varias tareas administrativas, como el mantenimiento del servidor y la huella energética, el software, la instalación, la implementación de parches y las copias de seguridad de la base de datos, así como de garantizar su alta disponibilidad, de planificar la escalabilidad y la seguridad de los datos, y de instalar el sistema operativo e instalarle los respectivos parches.

## Datos relacionales - *Amazon RDS*

AWS ofrece *Amazon RDS* (<https://aws.amazon.com/es/rds/>) como servicio administrado que configura y opera una base de datos relacional en la nube relacional, de manera que como desarrolladores sólo hemos de enfocar nuestros esfuerzos en los datos y optimizar nuestras aplicaciones.

### Instancias de bases de datos

El bloque de creación básico de Amazon RDS es la instancia de base de datos. Una instancia de base de datos es un entorno de base de datos aislado que puede contener varias bases de datos creadas por el usuario. Se puede acceder a él utilizando las mismas herramientas y aplicaciones que utiliza con una instancia de base de datos independiente. Los recursos que se encuentran en una instancia de base de datos se definen en función de la clase de instancia de base de datos, y el tipo de almacenamiento se determina por el tipo de disco. Las instancias y el almacenamiento de base de datos difieren en cuanto a las características de rendimiento y al precio, lo que le permite adaptar el costo y el rendimiento a las necesidades de su base de datos. Cuando elige crear una instancia de base de datos, primero tiene que especificar qué motor de base de datos ejecutar. Actualmente, AmazonRDS admite seis bases de datos: MySQL, Amazon Aurora, MicrosoftSQL Server, PostgreSQL, MariaDBy Oracle.

Puede ejecutar una instancia utilizando Amazon Virtual PrivateCloud (AmazonVPC). Cuando utiliza una nube virtual privada (VPC), tiene control sobre su entorno de red virtual. Puede seleccionar su propio intervalo de direccionesIP, crear subredes y configurar las listas de control de acceso (ACL) y el direccionamiento. La funcionalidad básica de AmazonRDS es la misma ya sea que se ejecute o no en una VPC. En general, la instancia de base de datos se encuentra aislada en una subred privada, y solo pueden acceder directamente a ella las instancias de aplicación determinadas. Las subredes de una VPC están asociadas a una única zona de disponibilidad, por lo que, cuando selecciona la subred, también elige la zona de disponibilidad (o la ubicación física) de su instancia de base de datos. Formación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.18

### Alta disponibilidad

Una de las características más importantes de AmazonRDS es la capacidad de configurar su instancia de base de datos para una alta disponibilidad con una implementación Multi-AZ. Una vez configurada la implementación Multi-AZ, AmazonRDS genera de manera automática una copia en espera de la instancia de base de datos en otra zona de disponibilidad dentro de la misma VPC. Después de propagar la copia de la base de datos, las transacciones se replican de forma sincrónica a la copia en espera. La ejecución de una instancia de base de datos en una implementación Multi-AZ puede mejorar la disponibilidad durante el mantenimiento programado del sistema y ayudar a proteger sus bases de datos contra los errores de las instancias de base de datos y la interrupción de la zona de disponibilidad. 

Por lo tanto, si la instancia de base de datos principal falla en una implementación Multi-AZ, AmazonRDS activa automáticamente la instancia de base de datos en espera como la nueva instancia principal. La replicación sincrónica minimiza la posibilidad de que haya pérdida de datos. Dado que sus aplicaciones hacen referencia a la base de datos por su nombre mediante el punto de enlace del sistema de nombres de dominio (DNS) de AmazonRDS, no tiene que cambiar nada en el código de las aplicaciones a fin de utilizar la copia en espera para la conmutación por error. Formación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.20

Replica de lectura

AmazonRDS también admite la creación de réplicas de lectura para MySQL, MariaDB, PostgreSQLy Amazon Aurora. Las actualizaciones que se realizan a la instancia de base de datos de origen se copian de manera asíncrona en la instancia de réplica de lectura. Puede reducir la carga sobre la instancia de base de datos de origen por medio del direccionamiento de las consultas de lectura desde sus aplicaciones a la réplica de lectura. Si se utilizan réplicas de lectura, también puede realizar un escalado horizontal más allá de los límites de capacidad de una única instancia de base de datos para cargas de trabajo de base de datos con operaciones intensivas de lectura. Las réplicas de lectura también pueden convertirse en la instancia de base de datos principal, pero, debido a la replicación asíncrona, esto debe hacerse de forma manual. Las réplicas de lectura pueden crearse en una región diferente a la utilizada por la base de datos principal. Esta característica puede ayudar a cumplir los requisitos de recuperación de desastres o a disminuir la latencia al dirigir las lecturas a una réplica de lectura que esté más cerca del usuario

### Casos de uso

AmazonRDS es ideal para las aplicaciones web y móviles que necesitan una base de datos con alto rendimiento, enorme escalabilidad en el almacenamiento y alta disponibilidad. Como no existen restricciones de licencia en AmazonRDS, el servicio se ajusta a los patrones de uso variable de estas aplicaciones. AmazonRDS ofrece a las empresas de comercio electrónico grandes y pequeñas una solución de base de datos flexible, segura y de bajo costo para la venta minorista y el comercio en línea. Los juegos móviles y en línea requieren una plataforma de base de datos con alto rendimiento y disponibilidad. AmazonRDS administra la infraestructura de la base de datos, de manera que los desarrolladores de videojuegos no tengan que preocuparse por aprovisionar, escalar o monitorear los servidores de base de datos. Formación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.22

Utilice AmazonRDS cuando su aplicación necesite lo siguiente: •Transacciones o consultas complejas•Tasa de consulta o escritura media a alta: hasta 30000IOPS (15000lecturas+ 15000escrituras)•No más de una única partición o nodo de trabajo•Alta durabilidadNo utilice AmazonRDS cuando su aplicación necesite lo siguiente:•Tasas de lectura o escritura muy grandes (por ejemplo, 150000 escrituras por segundo)•Fragmentación causada por el gran tamaño de los datos o las altas demandas de rendimiento •Solicitudes y consultas GET o PUT simples que una base de datos NoSQLpueda manejar•O personalización del sistema de administración de bases de datos relacionales (RDBMS)En los casos en que no deba utilizar Amazon RDS, considere la posibilidad de utilizar una solución de base de datos NoSQL, como DynamoDB, o ejecutar su motor de base de datos relacional en instancias de AmazonEC2 en lugar de AmazonRDS, lo cual le proporcionará más opciones para personalizar la base de datos.

### Costes

Cuando comience a calcular el costo de AmazonRDS, debe tener en cuenta las horas de reloj del servicio, que son recursos que generan cargos cuando se ejecutan (por ejemplo, desde el momento en que lanza una instancia de base de datos hasta que la termina). También hay que tener en cuenta las características de la base de datos. La capacidad física de la base de datos que elija tendrá un efecto sobre cuánto se le cobre. Las características de la base de datos varían según el motor, el tamaño y la clase de memoria de la base de datos

Tenga en cuenta el tipo de compra de base de datos. Cuando utiliza instancias bajo demanda, paga la capacidad de cómputo por cada hora en que se ejecuta su instancia de base de datos, sin necesidad de compromisos mínimos. Con las instancias reservadas, puede realizar un pequeño pago inicial único por cada instancia de base de datos que desee reservar por un periodo de1 o 3años. También debe tener en cuenta la cantidad de instancias de base de datos. Con AmazonRDS, puede aprovisionar varias instancias de base de datos para gestionar cargas máximas. Formación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.25

Considere el almacenamiento aprovisionado. No hay cargos adicionales por el almacenamiento para copias de seguridad de hasta el 100% de su almacenamiento de base de datos aprovisionado para una instancia de base de datos activa. Una vez que se termina la instancia de base de datos, el almacenamiento para copias de seguridad se factura por GB por mes. También tenga en cuenta la cantidad de almacenamiento para copias de seguridad que se suma a la cantidad de almacenamiento aprovisionado, la cual se factura por GB por mes. Formación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.26

Además, considere la cantidad de solicitudes de entrada y de salida que se realizaron a la base de datos.Considere el tipo de implementación. Puede implementar su instancia de base de datos en una única zona de disponibilidad (lo que equivale a un centro de datos independiente) o en varias zonas de disponibilidad (lo que equivale a un centro de datos secundario para disponer de mayor disponibilidad y durabilidad). Los cargos por almacenamiento y operaciones de E/S varían según la cantidad de zonas de disponibilidad en las que se realiza la implementación. Por último, tenga en cuenta la transferencia de datos. La transferencia entrante de datos es gratuita, y los costos por la transferencia saliente se aplican por niveles. Según las necesidades de la aplicación, es posible optimizar los costos de las instancias de base de datos de AmazonRDS mediante la adquisición de instancias reservadas. Para comprar instancias reservadas, debe realizar un pequeño pago único por cada instancia que desee reservar. Como resultado, recibirá un descuento considerable en el cargo por uso por hora de dicha instancia.Formación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.27

## Amazon Aurora

Amazon Aurora es una base de datos relacional compatible con MySQLy PostgreSQLque se creó para la nube. Combina el rendimiento y la disponibilidad de las bases de datos comerciales de alta gama con la simplicidad y la rentabilidad de las bases de datos de código abierto. El uso de Amazon Aurora puede reducir los costos de la base de datos y, al mismo tiempo, mejorar la fiabilidad y la disponibilidad de la base de datos. Como servicio completamente administrado, Aurora está diseñado para automatizar tareas cuya realización requiere mucho tiempo, como el aprovisionamiento, la implementación de parches, la realización de copias de seguridad, la recuperación, la detección de errores y la reparación.Formación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.60

En resumen, Amazon Aurora es una base de datos relacional administrada de manera rentable, con alta disponibilidad y buen rendimiento.Aurora ofrece un subsistema de almacenamiento distribuido de alto rendimiento. El uso de Amazon Aurora puede reducir los costos de la base de datos y, al mismo tiempo, mejorar su fiabilidad. Aurora también está diseñado para ofrecer alta disponibilidad. Posee almacenamiento tolerante a errores y con recuperación automática creado para la nube. Aurora replica varias copias de los datos en múltiples zonas de disponibilidad y realiza copias de seguridad continuas de los datos en AmazonS3. Hay varios niveles de seguridad disponibles, incluidos el aislamiento de la red con Amazon VPC, el cifrado en reposo por medio de claves creadas y controladas con AWS Key Management Service(KMS) y el cifrado de los datos en tránsito con la capa de conexión segura (SSL).El motor de base de datos Amazon Aurora es compatible con las bases de datos de código abierto MySQLy PostgreSQLexistentes, e incorpora compatibilidad con las nuevas versiones de manera frecuente.Por último, Amazon Aurora está completamente administrado por Amazon RDS. Aurora automatiza las tareas de administración de bases de datos, como el aprovisionamiento de hardware, la implementación de parches en el software, la
instalación, la configuración o la realización de copias de seguridad.

## Datos NoSQL - *DynamoDB*

DynamoDB (<https://aws.amazon.com/es/dynamodb/>) es un servicio de base de datos NoSQL rápido y flexible para todas las aplicaciones que requieren una latencia uniforme de milisegundos de un solo dígito a cualquier escala. Amazon administra toda la infraestructura subyacente de datos para este servicio y almacena los datos de manera redundante en varias instalaciones dentro de una región nativa de EE.UU., como parte de la arquitectura tolerante a errores. Con DynamoDB, puede crear tablas y elementos. Puede agregar elementos a una tabla. El sistema particionasus datos automáticamente y cuenta con el almacenamiento de tablas necesario para cumplir con los requisitos de carga de trabajo. No existe ningún límite práctico respecto de la cantidad de elementos que se pueden almacenar en una tabla. Por ejemplo, algunos clientes tienen tablas de producción con miles de millones de elementos. Uno de los beneficios de las bases de datos NoSQLes que los elementos de la misma tabla pueden tener atributos diferentes. Esto le da flexibilidad para agregar atributos a medida que la aplicación evoluciona. Puede almacenar elementos con formatos más nuevos junto a otros con formatos más antiguos en la misma tabla, sin tener que realizar migraciones de esquema.Formación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.39

A medida que su aplicación se vuelve más popular y los usuarios continúan interactuando con ella, el almacenamiento puede crecer según las necesidades de la aplicación. Todos los datos de DynamoDBse almacenan en unidades de estado sólido (SSD), y su lenguaje de consulta simple permite un rendimiento de las consultas uniforme y de baja latencia. Además de escalar el almacenamiento, DynamoDBle permite aprovisionar el volumen del rendimiento de lectura o escritura que necesita para su tabla. A medida que aumenta la cantidad de usuarios de la aplicación, las tablas de DynamoDBse pueden escalar para admitir el incremento de las solicitudes de lectura y escritura mediante el aprovisionamiento manual. De forma alternativa, puede habilitar el escalado automático para que DynamoDBmonitoree la carga de la tabla e incremente o disminuya el rendimiento aprovisionado de manera automática. Algunas otras características clave incluyen las tablas globales que le permiten generar réplicas de manera automática en las regiones de AWS que elija, el cifrado en reposo y la visibilidad del tiempo de vida (TTL) de los elementos. Formación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.40

DynamoDBes un servicio de base de datos NoSQLcompletamente administrado. Amazon administra toda la infraestructura de datos subyacente para este servicio y almacena los datos de manera redundante en varias instalaciones dentro de una región nativa de EE.UU. como parte de la arquitectura tolerante a errores. Con DynamoDB, puede crear tablas y elementos. Puede agregar elementos a una tabla. El sistema particionasus datos automáticamente y cuenta con el almacenamiento de tablas necesario para cumplir con los requisitos de carga de trabajo. No existe ningún límite práctico respecto de la cantidad de elementos que se pueden almacenar en una tabla. Por ejemplo, algunos clientes tienen tablas de producción con miles de millones de elementos. Uno de los beneficios de una base de datos NoSQLes que los elementos en la misma tabla pueden tener diferentes atributos. Esto le da flexibilidad para agregar atributos a medida que la aplicación evoluciona. Puede almacenar elementos con formatos más nuevos junto a otros con formatos más antiguos en la misma tabla sin tener que realizar migraciones de esquema.A medida que su aplicación se vuelve más popular y los usuarios continúan interactuando con ella, el almacenamiento puede crecer según las necesidades de la aplicación. Todos los datos en DynamoDBse almacenan en discos de estado sólido, y el lenguaje de consulta simple permite un rendimiento uniforme de las Formación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.41

consultas de baja latencia. Además de proporcionar escalado del almacenamiento, DynamoDBle permite aprovisionar el volumen del rendimiento de lectura o escritura que necesita para su tabla. A medida que aumenta la cantidad de usuarios de la aplicación, las tablas de DynamoDBse pueden escalar para admitir el incremento de solicitudes de escritura y lectura mediante el aprovisionamiento manual. De forma alternativa, puede habilitar el escalado automático para que DynamoDBmonitoree la carga de la tabla e incremente o disminuya el rendimiento aprovisionado de manera automática. Algunas otras características clave de diferenciación incluyen las tablas globales que le permiten generar réplicas de manera automática en las regiones de AWS que elija, el cifrado en reposo y la visibilidad del tiempo de vida (TTL) de los elementos. Formación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.42

Los componentes principales de DynamoDBson los elementos, las tablas y los atributos.•Una tabla es un conjunto de datos.•Los elementos son un grupo de atributos que se puede identificar de forma exclusiva entre todos los demás elementos.•Un atributo es un elemento de datos fundamental que no es preciso seguir dividiendo.DynamoDBadmite dos tipos distintos de claves principales: La clave de particiónes una clave principal simple que consta de un atributo denominado clave de ordenamiento.La clave de partición y de ordenamiento, también conocidas como clave principal compuesta,está conformada por dos atributos.Para obtener más información sobre cómo funciona DynamoDB, consulte Atributos de los elementos de la tablaFormación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.43

A medida que aumenta el volumen de datos, la clave principal particionae indexa los datos de la tabla. Puede recuperar los datos de una tabla de DynamoDBde dos formas distintas:•Según el primer método, la operación de consultas aprovecha la partición para localizar de manera eficaz los elementos por medio de la clave principal. •El segundo método se lleva a cabo mediante un escaneo, que le permite localizar los elementos de la tabla a partir de las coincidencias con las condiciones en los atributos que no son clave. El segundo método le da la flexibilidad necesaria para localizar elementos por medio de otros atributos. Sin embargo, esta operación es menos eficiente debido a que DynamoDBescanea todos los elementos de la tabla a fin de encontrar los que coinciden con sus parámetros. Formación y certificación de AWSMódulo 8: Bases de datos© 2020 Amazon Web Services, Inc. o sus filiales Todos los derechos reservados.44

Para aprovechar al máximo las operaciones de consulta y DynamoDB, es importante que la clave utilizada identifique de forma exclusiva los elementos de la tabla de DynamoDB. Puede configurar una clave principal simple basada en un único atributo de los valores de los datos con una distribución uniforme, como el identificador único global (GUID)u otros identificadores aleatorios. Por ejemplo, si quisiera modelar una tabla con productos, podría utilizar algunos atributos, como el ID de producto. De forma alternativa, puede especificar una clave compuesta, que incluye una clave de partición y una clave secundaria. En este ejemplo, si tuviera una tabla con libros, podría utilizar la combinación de autor y título para identificar de forma exclusiva los elementos de la tabla. Este método podría ser útil si espera evaluar libros por autor con frecuencia, ya que entonces podría utilizar la consulta

Resumen

DynamoDBse ejecuta exclusivamente en SSD y admite modelos de almacenamiento de clave-valor y documentos. DynamoDBfunciona bien con las aplicaciones móviles, web, de videojuegos, de tecnología publicitaria y de Internet de las cosas (IoT).Se puede acceder a este servicio a través de la consola, de la CLI de AWS y de las llamadas a la API. La capacidad de escalar sus tablas en términos de almacenamiento y rendimiento de aprovisionamiento hace que DynamoDBsea una buena opción para los datos estructurados de las aplicaciones web, móviles y de IoT. Por ejemplo, puede tener una gran cantidad de clientes que generan datos de manera continua y realizan numerosas solicitudes por segundo. En este caso, el escalado del rendimiento de DynamoDBproporciona un rendimiento uniforme a sus clientes. DynamoDBtambién se utiliza en aplicaciones que se ven afectadas por la latencia. El rendimiento predecible de las consultas, incluso en tablas grandes, lo hace útil para los casos en los que la latencia variable podría causar un impacto significativo en la experiencia del usuario o en los objetivos empresariales, como en el ámbito de la tecnología publicitaria o los videojuegos

Con la característica de tablas globales de DynamoDB, se reduce la tarea de replicar los datos entre las regiones y de solucionar los conflictos de actualización. Con esta característica, se replican automáticamente las tablas de DynamoDBen las regiones de AWS que elija. Las tablas globales pueden ayudar a que las aplicaciones mantengan la disponibilidad y el rendimiento necesarios para la continuidad del negocio

## DataWarehouse - *Redshift*

Amazon Redshift es un servicio de datawarehouses rápido y completamente administrado. A medida que el negocio crece, puede escalar de manera sencilla y sin tiempo de inactividad, ya que solo necesita agregar más nodos. Amazon Redshiftagrega de manera automática los nodos a su clúster y redistribuye los datos para alcanzar el máximo rendimiento.Este servicio está diseñado para ofrecer alto rendimiento de manera uniforme. Utiliza almacenamiento en columnas y una arquitectura de procesamiento en paralelo masivo. Estas características ubican en paralelo y distribuyen los datos y las consultas entre varios nodos. Amazon Redshifttambién monitorea su clúster y realiza copias de seguridad de los datos de forma automática para que pueda restaurarlos con facilidad si es necesario. El cifrado está integrado; solo tiene que habilitarlo.Para obtener más información acerca de Amazon Redshift, consultehttps://aws.amazon.com/redshift/. 

## Casos de Uso

Como se ha visto en este módulo,la nube continúa reduciendo el costo de almacenamiento y de cómputo. Ha surgido una nueva generación de aplicaciones,la cual, a su vez, ha creado un nuevo conjunto de requisitos para las bases de datos. Estasaplicacionesnecesitan bases de datos capaces de almacenar desde terabytes hasta petabytesde nuevos tiposde datos, proporcionar acceso a los datos con una latencia de milisegundos, procesar millones de solicitudes porsegundo y escalar para admitir millones de usuariosen cualquier partedel mundo. Para cumplir estos requisitos, se necesitan bases de datos relacionales y no relacionales diseñadas especialmente para gestionar las necesidades específicas de las aplicaciones. AWS ofrece una amplia variedad de bases de datos personalizadas para sus casos de uso de aplicacionesespecíficos.



## Actividades

1. Realizar el módulo 8 (Bases de Datos) del curso [ACF de AWS](https://awsacademy.instructure.com/courses/2243/).

2. Crear una bd en RDS y cargar datos

3. Crear una tabla en DynamoDB y cargar datos

## Referencias

* 
